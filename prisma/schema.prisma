generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Posyandu {
  id        String   @id @default(cuid()) @map("posyandu_id")
  name      String   @unique @map("nama")
  users     User[]
  anak      Anak[]
  createdAt DateTime @default(now()) @map("tanggal_dibuat")
  updatedAt DateTime @updatedAt @map("tanggal_diubah")

  @@map("posyandu")
}

enum Role {
  BIDAN
  KADER
}

enum Gender {
  LAKI_LAKI
  PEREMPUAN
}

model User {
  id         String    @id @default(cuid()) @map("user_id")
  name       String    @map("nama")
  email      String    @unique
  password   String
  role       Role
  posyanduId String?   @map("posyandu_id")
  posyandu   Posyandu? @relation(fields: [posyanduId], references: [id])
  createdAt  DateTime  @default(now()) @map("tanggal_dibuat")
  updatedAt  DateTime  @updatedAt @map("tanggal_diubah")

  @@map("user")
}

model Anak {
  id           String        @id @default(cuid()) @map("anak_id")
  nik          String        @unique
  name         String        @map("nama")
  placeOfBirth String?       @map("tempat_lahir")
  dateOfBirth  DateTime      @map("tanggal_lahir")
  gender       Gender        @map("jenis_kelamin")
  parentName   String        @map("nama_orangtua")
  posyanduId   String        @map("posyandu_id")
  posyandu     Posyandu      @relation(fields: [posyanduId], references: [id])
  measurements Measurement[]
  createdAt    DateTime      @default(now()) @map("tanggal_dibuat")
  updatedAt    DateTime      @updatedAt @map("tanggal_diubah")

  @@map("anak")
}

model Measurement {
  id          String   @id @default(cuid()) @map("pengukuran_id")
  anakId      String   @map("anak_id")
  anak        Anak     @relation(fields: [anakId], references: [id])
  date        DateTime @default(now()) @map("tanggal")
  weight      Float    @map("berat_badan")
  height      Float    @map("tinggi_badan")
  ageInMonths Int      @map("usia_bulan")
  zScoreBBTB  String?  @map("z_score_bbtb")
  zScoreBBU   String?  @map("z_score_bbu")
  zScoreTBU   String?  @map("z_score_tbu")
  notes       String?  @map("catatan")
  createdAt   DateTime @default(now()) @map("tanggal_dibuat")
  updatedAt   DateTime @updatedAt @map("tanggal_diubah")

  @@map("pengukuran")
}
